{% extends "base.html.twig" %}

{% block title %}Ajout observation - {{parent()}}{% endblock %}
{% block body_id route %}
{% block main_id %}main_{{route}}{% endblock %}

{% block mainLeft %}
    <div id="main-left" class="col-lg-5 col-xl-4">
        <div class="d-flex flex-column">
            <div class=" mt-auto mb-auto">
                <h1 class="text-white display-3">{{ options.page.title|default("Nouvelle Observation") }}</h1>
                <p class="text-primary lead">{{ options.page.subtitle }}</p>
            </div>

            {% if app.session.get("step") == 1 %}
            <div>
                <button id="getCurrentPosition" class="btn btn-link">
                    <i class="material-icons">gps_fixed</i> Me localiser
                </button>
            </div>
            {% endif %}


            <div class="wrapper newObs">
                {% if app.session.get('step') != 4 %}
                    {{ include('admin/observation/_form.html.twig', {
                        form: form,
                        route:route,
                        button_label: options.form.button_label|default('étape suivante'),
                        include_back_btn: options.form.include_back_btn,
                        back_btn_label: options.form.back_btn_label|default('étape précédente'),
                        back_btn_path: options.form.back_btn_path,
                    }, with_context = false) }}
                    {% block obsAction %}{% endblock %}
                {% else %}
                    <div class="result">
                        {% for post in posts %}
                        {{ include('components/cards/taxref.html.twig', {
                            include_id_btn: true,
                        }) }}
                        {% endfor %}
                    </div>

                    {{ include('components/buttons/moreResults.html.twig', {
                        route:'taxref_index',
                    }) }}
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}

{% block mainRight %}
    {% set mapClass = 'step'~app.session.get('step') %}

    <div id="main-map" class="col-lg-7 col-xl-8 p-0 {{mapClass}}"><div id="map"></div></div>
    {{ include('components/apiMap/observation_new.html.twig') }}
{% endblock %}

{% block javascripts %}
    {{parent()}}
    <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDED89bCETmWyPqiKoncfU6-g3GkHzGY1Y&callback=initMap">
    </script>
{% endblock %}