{% extends "base.html.twig" %}

{% block title %}Test Home - {{parent()}}{% endblock %}

{% block stylesheets %}{% endblock %}

{% block mainLeft %}
<div class='row no-gutters'>
    <div class="d-flex justify-content-around align-items-md-center flex-wrap">
    <div class=" col-lg-3 col-xl-3 h-75">
        <div class="row no-gutters"> 
            <h2 class="text-white display-4">Espace personnel</h2>
            <p class="text-primary lead">Vous pouvez accéder aux fonctionalités clés du site</p> 
            <div class="col-sm-12">
                <div><a class="btn btn-block btn-primary text-muted" href="">Voir mes Observations</a></div>
                <div><a class="btn btn-block btn-primary text-muted " href="">Ajouter une observation</a></div>
                <div><a class="btn btn-block btn-primary text-muted " href="">Editer mon profil</a></div>
            </div>  
        </div>        
    </div>
    
    <div class=' col-lg-7 col-xl-7 h-75 '>
        
        <ul class="nav nav-tabs " role="tablist">
            <li class="nav-item">
                <a class="nav-link active" href="#lastObs" role="tab" data-toggle="tab">Mes dernières observations</a>
            </li>
            {% if is_granted('ROLE_NATURALIST')%}
                <li class="nav-item">
                    <a class="nav-link" href="#toValid" role="tab" data-toggle="tab">Dernières observations en attente de validation</a>
                </li>
            {% endif %}
        </ul>

        <div class="tab-content">
            <div role="tabpanel" class="tab-pane active " id="lastObs">
                <table class="table">
                    <tr class="text-muted">
                        <th>Oiseau</th>
                        <th>Date d'ajout</th>
                        <th>Lieu</th>
                        <th>Statut</th>
                        <th>Voir</th>
                        <th>Supprimer</th>
                    </tr>
                    {% for observation in userObservations %}
                        <tr class="text-white">
                            <td>
                                <a href="{{ path('showObservation', {id: observation.getId()})}}">{{observation.getBird().getTaxref().getNomVernType()}}</a>
                            </td>
                            <td>
                                {{observation.getDateAdd().format('d-M-Y')}}
                            </td>
                            <td>
                                {% set location =  observation.getLocation().getAddress() |split(',',2) %}
                                
                                <a href="{{ path('showObservation', {id: observation.getId()}) }}">{{location[1]}}</a>        
                            </td>
                            <td>
                                {% if observation.getStatus() == 1 %}
                                    Validée
                                {% else %}
                                    En attente de validation
                                {% endif %}

                            </td>
                            <th><a href="">voir</a></th>
                            <th><a href="">supprimer</a></th>
                        </tr>
                    {% endfor %}
                </table>
            </div>
            {% if is_granted('ROLE_NATURALIST')%}
                <div role="tabpanel" class="tab-pane" id="toValid">
                    <table class="table">
                        <tr class="text-muted">
                            <th>Oiseau</th>
                            <th>Date d'ajout</th>
                            <th>Lieu</th>
                            <th>Observateur</th>
                            <th>Valider</th>
                            <th>Supprimer</th>
                        </tr>
                        {% for observation in obsToValid %}
                            <tr class="text-white">
                                <td>
                                    <a href="{{ path('showObservation', {id: observation.getId()})}}">{{observation.getBird().getTaxref().getNomVernType()}}</a>
                                </td>
                                <td>{{observation.getDateAdd().format('d-M-Y')}}</td>
                                <td>
                                    {% set location =  observation.getLocation().getAddress() |split(',',2) %}
                                    <a href="{{ path('showObservation', {id: observation.getId()}) }}">{{location[1]}}</a>
                                </td>
                                <td>{{observation.getUser().getUsername}}</td>
                                <th><a href="">valider</a></th>
                                <th><a href="">supprimer</a></th>
                            </tr>
                        {% endfor %}
                    </table>
                </div>
            {% endif %}
        </div>
       
    </div>
    </div>

</div>


{% endblock %}

