{% extends 'admin/layout.html.twig' %}

{% block body_id route %}

{% block main_header %}
  <div id="main-header" class="row observation-preview">
    <ul class="nav justify-content-center w-100" id="myTab" role="tablist" >
      <li class="nav-item col">
        <a class="nav-link active" id="all-tab" data-toggle="tab" href="#allObs" role="tab" aria-controls="allObs" aria-selected="true">
          <div class="jumbotron">
              <h2 class="title">Mes observations</h2>
              <p class="lead">{{posts|length}}</p>
          </div>
        </a>
      </li>
      <li class="nav-item col">
        <a class="nav-link" id="valid-tab" data-toggle="tab" href="#validObs" role="tab" aria-controls="validObs" aria-selected="false">
          <div class="jumbotron">
              <h2 class="title">En ligne</h2>
              {% set countInline = 0 %}
              {% for inline in posts if inline.status == 1 %}
                  {% set countInline = countInline + 1 %}
              {% endfor %}
              <p class="lead">{{ countInline }}</p>
          </div>
        </a>
      </li>
      <li class="nav-item col">
          <a class="nav-link" id="wait-tab" data-toggle="tab" href="#waitObs" role="tab" aria-controls="waitObs" aria-selected="false">
            <div class="jumbotron">
                <h2 class="title">En cours validation</h2>
                {% set countWait = 0 %}
                {% for wait in posts if wait.status == 0 %}
                    {% set countWait = countWait + 1 %}
                {% endfor %}
                <p class="lead">{{countWait}}</p>
            </div>
          </a>
        </li>
      <li class="nav-item col">
        <a class="nav-link" id="check-tab" data-toggle="tab" href="#checkObs" role="tab" aria-controls="checkObs" aria-selected="false">
          <div class="jumbotron">
              <h2 class="title">A valider</h2>
              <p class="lead">{{postsToCheck|length}}</p>
          </div>
        </a>
      </li>
    </ul>
  </div>
{% endblock %}

{% block main_content %}
  <div class="tab-content" id="myTabContent">
    <!-- Toute les observation de l'utilisateur -->
    {{ include('components/tabPane.html.twig', {
      posts: posts,
      type:  'all',
      title: 'Toutes mes observations',
      cols:  ['Lieu','Moment','Oiseau','Status']
    }) }}
    <!-- En ligne -->
    {{ include('components/tabPane.html.twig', {
      posts: posts,
      type:  'valid',
      title: 'Mes observations en ligne',
      cols:  ['Lieu','Moment','Oiseau','Status']
    }) }}
    <!-- En cours de validation -->
    {{ include('components/tabPane.html.twig', {
      posts: posts,
      type:  'wait',
      title: 'Mes observations en cours de validation',
      cols:  ['Lieu','Moment','Oiseau','Status']
    }) }}
    <!-- <div class="tab-pane fade" id="waitObs" role="tabpanel" aria-labelledby="wait-tab">
      <div class="row observation">
        <div class="col">
          <h6 class="title">Mes observations (affichage 1 à 6 de 6 enregistrements)</h6>
        </div>
        <div class="col-auto">
          <button class="btn btn-primary mt-0">
            <i class="fa fa-plus"></i>
            Ajouter
          </button>
        </div>
      </div>
      <table class="table table-striped table-light mt-3">
        <thead>
          <tr>
            <th scope="col">Obs ID</th>
            <th scope="col">Lieu</th>
            <th scope="col">Moment</th>
            <th scope="col">Oiseau</th>
            <th scope="col">Statut</th>
            <th scope="col-action"></th>
          </tr>
        </thead>
        <tbody>
          {% for post in posts if post.status == 0 %}
            <tr>
              <th scope="row">{{ post.id }}</th>
              <td>{{post.location.address}}</td>
              <td> {{ post.ago(post.dateObs|date()) }} </td>
              <td> {{ post.bird.taxref.nomValideType }} </td>
              <td>
                <i class="fa fa-circle fa-fw {% if post.status == 1 %} text-primary{% else %}text-warning{% endif %} "></i>{{ post.statusDefinition(post.status) }}
              </td>
              <td class="text-right"><a href="{{ path('home') }}"><i class="fa fa-pencil"></i></a></td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div> -->
    <!-- A valider -->
    {{ include('components/tabPane.html.twig', {
      posts: postsToCheck,
      type:  'check',
      title: 'Les observations à valider',
      cols:  ['Lieu','Moment','Observateur','Mail']
    }) }}
    <!-- <div class="tab-pane fade" id="checkObs" role="tabpanel" aria-labelledby="check-tab">
      <div class="row observation">
        <div class="col">
          <h6 class="title">Mes observations (affichage 1 à 6 de 6 enregistrements)</h6>
        </div>
        <div class="col-auto">
          <button class="btn btn-primary mt-0">
            <i class="fa fa-plus"></i>
            Ajouter
          </button>
        </div>
      </div>
      <table class="table table-striped table-light mt-3">
        <thead>
          <tr>
            <th scope="col">Obs ID</th>
            <th scope="col">Lieu</th>
            <th scope="col">Oiseau</th>
            <th scope="col">Observateur</th>
            <th scope="col">Mail</th>
            <th scope="col-action"></th>
          </tr>
        </thead>
        <tbody>
          {% for post in postsToCheck %}
            <tr>
              <th scope="row">{{ post.id }}</th>
              <td>{{post.location.address}}</td>
              <td> {{ post.bird.taxref.nomValideType|default('') }} </td>
              <td> {{ post.user.name|default('') }} {{ post.user.surname|default('') }} </td>
              <td>
                <i class="fa fa-enveloppe-o fa-fw "></i>{{ post.user.mail|default('') }}
              </td>
              <td class="text-right"><a href="{{ path('home') }}"><i class="fa fa-check"></i></a></td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div> -->
  </div>


{% endblock %}
